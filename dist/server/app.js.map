{"version":3,"sources":["../../server/app.js"],"names":["info","createApp","setup","app","config","loglevel","use","bodyParser","json","forEach","validation","routes","routeNotFoundHandler","errorHandler","startApp","listen","port"],"mappings":";;;;;;;AAEA;;;;AACA;;;;AAEA;;;;AACA;;;;AAEA;;;;AACA;;AACA;;AACA;;AACA;;;;;;AAIA,MAAM,EAAEA,IAAF,KAAW,gBAAI,KAAJ,CAAjB;;AAEO,MAAMC;AAAA,+BAAY,WAAOC,KAAP,EAAwB;AAC/C,UAAMC,MAAM,wBAAZ;;AAEA,4BAAYC,iBAAOC,QAAnB;;AAEAF,QAAIG,GAAJ,CAAQ,8BAAkBF,iBAAOC,QAAzB,CAAR;AACAF,QAAIG,GAAJ,CAAQ,4BAAR;AACAH,QAAIG,GAAJ,CAAQ,uBAAR;AACAH,QAAIG,GAAJ,CAAQC,qBAAWC,IAAX,EAAR;;AAEA,6BAAkBN,KAAlB,EAAyBO,OAAzB,CAAiC;AAAA,aAAcN,IAAIG,GAAJ,CAAQI,UAAR,CAAd;AAAA,KAAjC;AACA,6BAAkBR,KAAlB,EAAyBO,OAAzB,CAAiC;AAAA,aAAcN,IAAIG,GAAJ,CAAQI,UAAR,CAAd;AAAA,KAAjC;;AAEA,UAAMC,SAAS,MAAM,oBAAaT,KAAb,CAArB;;AAEAC,QAAIG,GAAJ,CAAQK,MAAR;;AAEAR,QAAIG,GAAJ,CAAQM,2BAAR;AACAT,QAAIG,GAAJ,CAAQO,mBAAR;;AAEA,WAAOV,GAAP;AACD,GArBY;;AAAA;AAAA;AAAA;AAAA,IAAN;;AAuBA,MAAMW,8BAAYX,GAAD,IACtBA,IAAIY,MAAJ,CAAWX,iBAAOY,IAAlB,EAAwB,MAAM;AAC5BhB,OAAM,qCAAoCI,iBAAOY,IAAK,EAAtD;AACD,CAFD,CADK","file":"app.js","sourcesContent":["/* @flow */\n\nimport compression from 'compression';\nimport express from 'express';\nimport type { $Application } from 'express';\nimport helmet from 'helmet';\nimport bodyParser from 'body-parser';\n\nimport config from './config';\nimport { create as createRoutes } from './routes';\nimport { create as createValidations } from './validations';\nimport { create as createSimulations } from './simulations';\nimport { log, loggingMiddleware, setloglevel, routeNotFoundHandler, errorHandler } from './utils';\n\nimport type { Setup } from './types';\n\nconst { info } = log('app');\n\nexport const createApp = async (setup: Setup) => {\n  const app = express();\n\n  setloglevel(config.loglevel);\n\n  app.use(loggingMiddleware(config.loglevel));\n  app.use(compression());\n  app.use(helmet());\n  app.use(bodyParser.json());\n\n  createValidations(setup).forEach(validation => app.use(validation));\n  createSimulations(setup).forEach(validation => app.use(validation));\n\n  const routes = await createRoutes(setup);\n\n  app.use(routes);\n\n  app.use(routeNotFoundHandler);\n  app.use(errorHandler);\n\n  return app;\n};\n\nexport const startApp = (app: $Application): ?Server =>\n  app.listen(config.port, () => {\n    info(`The server is now running on port ${config.port}`);\n  });\n"]}